<html>
<head>
<script>


	function doOnOpen(evt) {
		console.log('doOnOpen');
		console.log(evt);
	};
  	function doOnClose(evt) {
		console.log("doOnClose");
		console.log(evt);
	};
	function doOnMessage(evt) {
		console.log("doOnMessage");
		console.log(evt);
	};

	var ws;
  function wsConnect() {
		var mypath = "/service"
		var wsUrl = "ws://" + window.location.host + mypath + "/ws";
		ws = new WebSocket(wsUrl);
		ws.onopen = doOnOpen;
		ws.onclose = doOnClose;
		ws.onmessage = doOnMessage;
	}
  
	function writeTable(table, msg) {
  	if (ws && ws.readyState === WebSocket.OPEN) {
			var serverMsg = {
				intent : 'WRITE',
				table : table,
				payload : msg
			};
			console.log(serverMsg);
			ws.send(JSON.stringify(serverMsg));
		}
  }
  
	function pushValue() {
    writeTable('write_value', {
				v : 'v' + getRandomInt(3)
			}
    );
	}
	
  function getRandomInt(max) {
    return Math.floor(Math.random() * Math.floor(max));
  }
	
</script>
</head>
<body>
	HELLO
	<button onclick="wsConnect()">Connect WS</button>
	<button onclick="pushValue()">Push Value</button>
</body>
</html>